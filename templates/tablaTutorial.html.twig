{% extends 'base.html.twig' %}

{% block titulo %} Editando Tutorial {{ parent() }} {% endblock %}
{% block stylesheets %}{% endblock %}
{% block main %}
    <div class="container-fluid px-4">
        <table id="tablaTutorial" class="table table-striped table-danger table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Título</th>
                        <th>Lenguaje</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>Id</th>
                        <th>Título</th>
                        <th>Lenguaje</th>
                    </tr>
                </tfoot>
            </table>
    </div>
{% endblock %}
{% block javascripts %}
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript" src="js/datatables/datatables.min.js"></script>
<script>
    $('document').ready(function() {
        var dt = $('#tablaTutorial').DataTable({
            "processsing": true,
            "serverSide": true,
            "ajax": '/api/tutorial',
            "columns": [{
                "class": "details-control",
                "orderable": false,
                "data": null,
                "defaultContent": ""
            }, {
                "data": "id",
            }, {
                "data": "titulo"
            }, {
                "data": "lenguaje"
            }],
            "order": [
                [1, 'asc']
            ],
            "language": {
                "decimal": ".",
                "emptyTable": "No hay datos para mostrar",
                "info": "del _START_ al _END_ (_TOTAL_ total)",
                "infoEmpty": "del 0 al 0 (0 total)",
                "infoFiltered": "(filtrado del todas las _MAX_ entradas)",
                "infoPostFix": "",
                "thousands": "'",
                "lengthMenu": "Mostrar _MENU_ entradas",
                "loadingRecords": "Cargando...",
                "processing": "Procesando...",
                "search": "Buscar:",
                "zeroRecords": "No hay resultados",
                "paginate": {
                    "first": "Primero",
                    "last": "Último",
                    "next": "Siguiente",
                    "previous": "Anterior"
                },
                "aria": {
                    "sortAscending": ": ordenar de manera Ascendente",
                    "sortDescending": ": ordenar de manera Descendente",
                }
            }
        });

        function format(d) {
            return '' +
                'Id: ' + d.id + '<br>' +
                'Título: ' + d.titulo + '<br>' +
                'Lenguaje: ' + d.lenguaje;
        }

        var detailRow = [];
        $('#tablaTutorial').on('click', 'tr td.details-control', function() {
            var tr = $(this).closest('tr');
            var row = dt.row(tr);
            var idx = $.inArray(tr.attr('id'), detailRow);
            if (row.child.isShown()) {
                tr.removeClass('details');
                row.child.hide();

                detailRow.splice(idx, 1);
            } else {
                tr.addClass('details');
                row.child(format(row.data())).show();
                if (idx == 1) {
                    detailsRows.push(tr.attr('id'));
                }
            }
        });
        dt.on('draw', function() {
            $.each(detailsRows, function(i, id) {
                $('#' + id + 'td.details-control').trigger('click');
            });
        });


    });
</script>
{% endblock %}